<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='黑群晖使用体验 刚毕业想到去年在淘宝买的蜗牛星际NAS存储，直到有较充裕的时间开始折腾下;\n说明下我的NAS为四盘位的蜗牛星际，待安装的系统为7.1.0-42661，可参考该文章，由于该教程过于简陋，所以下面介绍我的安装过程，顺便补充系统使用上的问题.\n制作U盘引导 引导一定要根据系统型号与版本进行选择，一般商家会提供U盘引导，并提供了特定pat文件;后续如果升级系统，可参考该引导配置制作新的U盘引导，最好用新的U盘制作U引导，下面介绍U盘引导的制作.\n准备工作 首先需要下载必要工具，链接：https://pan.baidu.com/s/1o8v7xdCPXgh3zIocm-iPcA 提取码：adja\n先烧录7.1的镜像，再修改U盘的grub.cfg文件，待修改参数包括pid、vid、sn、mac1、mac2、netif_num、DiskIdxMap、SataPortMap和SasIdxMap;\n获取pid、vid pid和vid参数可在插入U盘后，通过ChipEasyv1.6(pid vid读取工具）.exe获取;\n获取sn、mac、netif_num sn和mac(指mac1、mac2)可保持不变，也可以采用去某宝买全洗白的sn码;\nnetif_num表示网卡数量，有1个网卡则值为1，值为网卡数;\n获取DiskIdxMap、SataPortMap和SasIdxMap DiskIdxMap、SataPortMap和SasIdxMap可参考该文章，具体取值可问卖家客服或者通过tinycore工具(镜像为网盘的tinycore-redpill.v0.9.4.9.img文件，需烧录到U盘插入NAS)，tinycore工具使用可参考该文章，由于没有显示屏只有物理机无法看到NAS重启的引导界面，并且nas不好拆机，所以DiskIdxMap等直接采用卖家提供引导U盘的参数;\nSataPortMap: 描述各控制器的接口数，比如SataPortMap=22，表示第1个控制器有2个接口、第2个控制有2个接口，SataPortMap=345，表示第1个控制器有3个接口、第2个控制有4个接口、第3个控制有5个接口;\nDiskIdxMap: 描述磁盘的顺序，用2位16进制数表示1个控制器，比如SataPortMap=22 DiskIdxMap=0002，表示第1个控制器从第0号(00)磁盘开始，第2个控制器从第2号(02)磁盘开始，又比如SataPortMap=345 DiskIdxMap=070c00，表示第1个控制器从第7号(07)磁盘开始，第2个控制器从第12号(0c)磁盘开始，第3个控制器从第0号磁盘(00)开始，假设各控制器头顺序为BCA，如果DiskIdxMap取值为00070c，则顺序为ABC;\nSasIdxMap: 不清楚具体功能，文章说按照正确的顺序，默认加上;\n烧录镜像与修改grub.cfg Diskgenius（改pid vid sn mac删除硬盘）.exe用于修改img镜像文件，但不建议修改，由于只要修改grub.cfg文件，可先烧录img镜像到U盘，然后在U盘中修改;\n上面提到的烧录工具为Win32DiskImager(写盘工具）.exe，选择镜像和盘符，然后点击写入直到进度条满.\n最后给出我的grub.cfg文件:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 terminal_output console if serial --unit=0 --speed=115200; then terminal_input --append serial_com0 terminal_output --append serial_com0 fi set default="0" set timeout="5" set timeout_style="menu" if [ -s $prefix/grubenv ]; then load_env --file $prefix/grubenv --skip-sig set has_env="1" if [ -n "${saved_entry}" ]; then set default="${saved_entry}" fi else set has_env="0" echo "WARN: failed to load env. Default choice will NOT be saved!" fi function savedefault { saved_entry="${chosen}" save_env --file $prefix/grubenv saved_entry } insmod usb_keyboard insmod part_msdos insmod ext2 insmod fat insmod linux insmod gzio set gfxmode=auto insmod vbe insmod vga # UEFI insmod efi_gop insmod efi_uga insmod font if loadfont ${prefix}/unicode.pf2 then insmod gfxterm set gfxmode=auto set gfxpayload=keep terminal_output gfxterm fi menuentry &#39;RedPill DS918+ v7.1.0-42661 (USB, Verbose)&#39; { savedefault set root=(hd0,msdos1) echo Loading Linux... linux /zImage HddHotplug=0 withefi console=ttyS0,115200n8 netif_num=2 syno_hdd_detect=0 syno_port_thaw=1 vender_format_version=2 sn=xxx mac1=xxx mac2=xxx earlyprintk syno_hdd_powerup_seq=1 pid=0x5678 log_buf_len=32M syno_hw_version=DS918+ vid=0xffff earlycon=uart8250,io,0x3f8,115200n8 elevator=elevator root=/dev/md0 loglevel=15 DiskIdxMap=0002 SataPortMap=22 SasIdxMap=0 echo Loading initramfs... initrd /rd.gz /custom.gz echo Starting kernel with USB boot } menuentry &#39;RedPill DS918+ v7.1.0-42661 (SATA, Verbose)&#39; { savedefault set root=(hd0,msdos1) echo Loading Linux... linux /zImage HddHotplug=0 withefi console=ttyS0,115200n8 synoboot_satadom=2 DiskIdxMap=00 netif_num=1 syno_hdd_detect=0 syno_port_thaw=1 SasIdxMap=0 vender_format_version=2 earlyprintk mac1=xxx syno_hdd_powerup_seq=1 pid=0x5678 log_buf_len=32M syno_hw_version=DS918+ vid=0xffff earlycon=uart8250,io,0x3f8,115200n8 sn=xxx elevator=elevator root=/dev/md0 loglevel=15 SataPortMap=1 echo Loading initramfs... initrd /rd.gz /custom.gz echo Starting kernel with SATA boot echo WARNING: SATA boot support on this platform is experimental! } 系统安装 在安装之前，需要运行synology-assistant-7.win系统版.exe安装程序，在网盘已提供，用于扫描局域网中存在的NAS;\n'><title>黑群晖使用体验</title>
<link rel=canonical href=https://adja.com.cn/p/synology-user-experience/><link rel=stylesheet href=/scss/style.min.1604ecb5c9324fa2b73433bc3833664c3bd99557833943f19f0c6c91389d820d.css><meta property='og:title' content="黑群晖使用体验"><meta property='og:description' content='黑群晖使用体验 刚毕业想到去年在淘宝买的蜗牛星际NAS存储，直到有较充裕的时间开始折腾下;\n说明下我的NAS为四盘位的蜗牛星际，待安装的系统为7.1.0-42661，可参考该文章，由于该教程过于简陋，所以下面介绍我的安装过程，顺便补充系统使用上的问题.\n制作U盘引导 引导一定要根据系统型号与版本进行选择，一般商家会提供U盘引导，并提供了特定pat文件;后续如果升级系统，可参考该引导配置制作新的U盘引导，最好用新的U盘制作U引导，下面介绍U盘引导的制作.\n准备工作 首先需要下载必要工具，链接：https://pan.baidu.com/s/1o8v7xdCPXgh3zIocm-iPcA 提取码：adja\n先烧录7.1的镜像，再修改U盘的grub.cfg文件，待修改参数包括pid、vid、sn、mac1、mac2、netif_num、DiskIdxMap、SataPortMap和SasIdxMap;\n获取pid、vid pid和vid参数可在插入U盘后，通过ChipEasyv1.6(pid vid读取工具）.exe获取;\n获取sn、mac、netif_num sn和mac(指mac1、mac2)可保持不变，也可以采用去某宝买全洗白的sn码;\nnetif_num表示网卡数量，有1个网卡则值为1，值为网卡数;\n获取DiskIdxMap、SataPortMap和SasIdxMap DiskIdxMap、SataPortMap和SasIdxMap可参考该文章，具体取值可问卖家客服或者通过tinycore工具(镜像为网盘的tinycore-redpill.v0.9.4.9.img文件，需烧录到U盘插入NAS)，tinycore工具使用可参考该文章，由于没有显示屏只有物理机无法看到NAS重启的引导界面，并且nas不好拆机，所以DiskIdxMap等直接采用卖家提供引导U盘的参数;\nSataPortMap: 描述各控制器的接口数，比如SataPortMap=22，表示第1个控制器有2个接口、第2个控制有2个接口，SataPortMap=345，表示第1个控制器有3个接口、第2个控制有4个接口、第3个控制有5个接口;\nDiskIdxMap: 描述磁盘的顺序，用2位16进制数表示1个控制器，比如SataPortMap=22 DiskIdxMap=0002，表示第1个控制器从第0号(00)磁盘开始，第2个控制器从第2号(02)磁盘开始，又比如SataPortMap=345 DiskIdxMap=070c00，表示第1个控制器从第7号(07)磁盘开始，第2个控制器从第12号(0c)磁盘开始，第3个控制器从第0号磁盘(00)开始，假设各控制器头顺序为BCA，如果DiskIdxMap取值为00070c，则顺序为ABC;\nSasIdxMap: 不清楚具体功能，文章说按照正确的顺序，默认加上;\n烧录镜像与修改grub.cfg Diskgenius（改pid vid sn mac删除硬盘）.exe用于修改img镜像文件，但不建议修改，由于只要修改grub.cfg文件，可先烧录img镜像到U盘，然后在U盘中修改;\n上面提到的烧录工具为Win32DiskImager(写盘工具）.exe，选择镜像和盘符，然后点击写入直到进度条满.\n最后给出我的grub.cfg文件:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 terminal_output console if serial --unit=0 --speed=115200; then terminal_input --append serial_com0 terminal_output --append serial_com0 fi set default="0" set timeout="5" set timeout_style="menu" if [ -s $prefix/grubenv ]; then load_env --file $prefix/grubenv --skip-sig set has_env="1" if [ -n "${saved_entry}" ]; then set default="${saved_entry}" fi else set has_env="0" echo "WARN: failed to load env. Default choice will NOT be saved!" fi function savedefault { saved_entry="${chosen}" save_env --file $prefix/grubenv saved_entry } insmod usb_keyboard insmod part_msdos insmod ext2 insmod fat insmod linux insmod gzio set gfxmode=auto insmod vbe insmod vga # UEFI insmod efi_gop insmod efi_uga insmod font if loadfont ${prefix}/unicode.pf2 then insmod gfxterm set gfxmode=auto set gfxpayload=keep terminal_output gfxterm fi menuentry &#39;RedPill DS918+ v7.1.0-42661 (USB, Verbose)&#39; { savedefault set root=(hd0,msdos1) echo Loading Linux... linux /zImage HddHotplug=0 withefi console=ttyS0,115200n8 netif_num=2 syno_hdd_detect=0 syno_port_thaw=1 vender_format_version=2 sn=xxx mac1=xxx mac2=xxx earlyprintk syno_hdd_powerup_seq=1 pid=0x5678 log_buf_len=32M syno_hw_version=DS918+ vid=0xffff earlycon=uart8250,io,0x3f8,115200n8 elevator=elevator root=/dev/md0 loglevel=15 DiskIdxMap=0002 SataPortMap=22 SasIdxMap=0 echo Loading initramfs... initrd /rd.gz /custom.gz echo Starting kernel with USB boot } menuentry &#39;RedPill DS918+ v7.1.0-42661 (SATA, Verbose)&#39; { savedefault set root=(hd0,msdos1) echo Loading Linux... linux /zImage HddHotplug=0 withefi console=ttyS0,115200n8 synoboot_satadom=2 DiskIdxMap=00 netif_num=1 syno_hdd_detect=0 syno_port_thaw=1 SasIdxMap=0 vender_format_version=2 earlyprintk mac1=xxx syno_hdd_powerup_seq=1 pid=0x5678 log_buf_len=32M syno_hw_version=DS918+ vid=0xffff earlycon=uart8250,io,0x3f8,115200n8 sn=xxx elevator=elevator root=/dev/md0 loglevel=15 SataPortMap=1 echo Loading initramfs... initrd /rd.gz /custom.gz echo Starting kernel with SATA boot echo WARNING: SATA boot support on this platform is experimental! } 系统安装 在安装之前，需要运行synology-assistant-7.win系统版.exe安装程序，在网盘已提供，用于扫描局域网中存在的NAS;\n'><meta property='og:url' content='https://adja.com.cn/p/synology-user-experience/'><meta property='og:site_name' content="Loong's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='网络'><meta property='article:tag' content='实践'><meta property='article:published_time' content='2023-06-28T10:21:51+08:00'><meta property='article:modified_time' content='2024-12-08T15:41:04+08:00'><meta property='og:image' content='https://adja.com.cn/p/synology-user-experience/cover.jpg'><meta name=twitter:title content="黑群晖使用体验"><meta name=twitter:description content='黑群晖使用体验 刚毕业想到去年在淘宝买的蜗牛星际NAS存储，直到有较充裕的时间开始折腾下;\n说明下我的NAS为四盘位的蜗牛星际，待安装的系统为7.1.0-42661，可参考该文章，由于该教程过于简陋，所以下面介绍我的安装过程，顺便补充系统使用上的问题.\n制作U盘引导 引导一定要根据系统型号与版本进行选择，一般商家会提供U盘引导，并提供了特定pat文件;后续如果升级系统，可参考该引导配置制作新的U盘引导，最好用新的U盘制作U引导，下面介绍U盘引导的制作.\n准备工作 首先需要下载必要工具，链接：https://pan.baidu.com/s/1o8v7xdCPXgh3zIocm-iPcA 提取码：adja\n先烧录7.1的镜像，再修改U盘的grub.cfg文件，待修改参数包括pid、vid、sn、mac1、mac2、netif_num、DiskIdxMap、SataPortMap和SasIdxMap;\n获取pid、vid pid和vid参数可在插入U盘后，通过ChipEasyv1.6(pid vid读取工具）.exe获取;\n获取sn、mac、netif_num sn和mac(指mac1、mac2)可保持不变，也可以采用去某宝买全洗白的sn码;\nnetif_num表示网卡数量，有1个网卡则值为1，值为网卡数;\n获取DiskIdxMap、SataPortMap和SasIdxMap DiskIdxMap、SataPortMap和SasIdxMap可参考该文章，具体取值可问卖家客服或者通过tinycore工具(镜像为网盘的tinycore-redpill.v0.9.4.9.img文件，需烧录到U盘插入NAS)，tinycore工具使用可参考该文章，由于没有显示屏只有物理机无法看到NAS重启的引导界面，并且nas不好拆机，所以DiskIdxMap等直接采用卖家提供引导U盘的参数;\nSataPortMap: 描述各控制器的接口数，比如SataPortMap=22，表示第1个控制器有2个接口、第2个控制有2个接口，SataPortMap=345，表示第1个控制器有3个接口、第2个控制有4个接口、第3个控制有5个接口;\nDiskIdxMap: 描述磁盘的顺序，用2位16进制数表示1个控制器，比如SataPortMap=22 DiskIdxMap=0002，表示第1个控制器从第0号(00)磁盘开始，第2个控制器从第2号(02)磁盘开始，又比如SataPortMap=345 DiskIdxMap=070c00，表示第1个控制器从第7号(07)磁盘开始，第2个控制器从第12号(0c)磁盘开始，第3个控制器从第0号磁盘(00)开始，假设各控制器头顺序为BCA，如果DiskIdxMap取值为00070c，则顺序为ABC;\nSasIdxMap: 不清楚具体功能，文章说按照正确的顺序，默认加上;\n烧录镜像与修改grub.cfg Diskgenius（改pid vid sn mac删除硬盘）.exe用于修改img镜像文件，但不建议修改，由于只要修改grub.cfg文件，可先烧录img镜像到U盘，然后在U盘中修改;\n上面提到的烧录工具为Win32DiskImager(写盘工具）.exe，选择镜像和盘符，然后点击写入直到进度条满.\n最后给出我的grub.cfg文件:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 terminal_output console if serial --unit=0 --speed=115200; then terminal_input --append serial_com0 terminal_output --append serial_com0 fi set default="0" set timeout="5" set timeout_style="menu" if [ -s $prefix/grubenv ]; then load_env --file $prefix/grubenv --skip-sig set has_env="1" if [ -n "${saved_entry}" ]; then set default="${saved_entry}" fi else set has_env="0" echo "WARN: failed to load env. Default choice will NOT be saved!" fi function savedefault { saved_entry="${chosen}" save_env --file $prefix/grubenv saved_entry } insmod usb_keyboard insmod part_msdos insmod ext2 insmod fat insmod linux insmod gzio set gfxmode=auto insmod vbe insmod vga # UEFI insmod efi_gop insmod efi_uga insmod font if loadfont ${prefix}/unicode.pf2 then insmod gfxterm set gfxmode=auto set gfxpayload=keep terminal_output gfxterm fi menuentry &#39;RedPill DS918+ v7.1.0-42661 (USB, Verbose)&#39; { savedefault set root=(hd0,msdos1) echo Loading Linux... linux /zImage HddHotplug=0 withefi console=ttyS0,115200n8 netif_num=2 syno_hdd_detect=0 syno_port_thaw=1 vender_format_version=2 sn=xxx mac1=xxx mac2=xxx earlyprintk syno_hdd_powerup_seq=1 pid=0x5678 log_buf_len=32M syno_hw_version=DS918+ vid=0xffff earlycon=uart8250,io,0x3f8,115200n8 elevator=elevator root=/dev/md0 loglevel=15 DiskIdxMap=0002 SataPortMap=22 SasIdxMap=0 echo Loading initramfs... initrd /rd.gz /custom.gz echo Starting kernel with USB boot } menuentry &#39;RedPill DS918+ v7.1.0-42661 (SATA, Verbose)&#39; { savedefault set root=(hd0,msdos1) echo Loading Linux... linux /zImage HddHotplug=0 withefi console=ttyS0,115200n8 synoboot_satadom=2 DiskIdxMap=00 netif_num=1 syno_hdd_detect=0 syno_port_thaw=1 SasIdxMap=0 vender_format_version=2 earlyprintk mac1=xxx syno_hdd_powerup_seq=1 pid=0x5678 log_buf_len=32M syno_hw_version=DS918+ vid=0xffff earlycon=uart8250,io,0x3f8,115200n8 sn=xxx elevator=elevator root=/dev/md0 loglevel=15 SataPortMap=1 echo Loading initramfs... initrd /rd.gz /custom.gz echo Starting kernel with SATA boot echo WARNING: SATA boot support on this platform is experimental! } 系统安装 在安装之前，需要运行synology-assistant-7.win系统版.exe安装程序，在网盘已提供，用于扫描局域网中存在的NAS;\n'><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://adja.com.cn/p/synology-user-experience/cover.jpg'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_b6e36b0c09f169b7.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🍥</span></figure><div class=site-meta><h1 class=site-name><a href=/>Loong's Blog</a></h1><h2 class=site-description></h2></div></header><ol class=menu-social><li><a href=mailto:theone1221@qq.com target=_blank title=Email rel=me><svg class="icon" viewBox="0 0 1024 1024" data-darkreader-inline-fill="" data-spm-anchor-id="a313x.search_index.0.i7.7cb13a81NKNRJj" width="24" height="24"><path d="M874.666667 181.333333H149.333333C108.8 181.333333 74.666666 215.466666 74.666667 256v512c0 40.533333 34.133333 74.666667 74.666666 74.666667h725.333334c40.533333.0 74.666667-34.133333 74.666666-74.666667V256c0-40.533333-34.133333-74.666667-74.666666-74.666667zm-725.333334 64h725.333334c6.4.0 10.666667 4.266667 10.666666 10.666667v25.6L512 516.266667 138.666667 281.6V256c0-6.4 4.266667-10.666667 10.666666-10.666667zm725.333334 533.333334H149.333333c-6.4.0-10.666667-4.266667-10.666666-10.666667V356.266667l356.266666 224C499.2 584.533334 505.6 584.533334 512 584.533333s12.8-2.133333 17.066667-4.266666l356.266666-224V768c0 6.4-4.266667 10.666667-10.666666 10.666667z" fill="#000" style="--darkreader-inline-fill:#ccc8c1"/></svg></a></li><li><a href=https://github.com/adjaisd target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页</span></a></li><li><a href=/%E5%85%B3%E4%BA%8E/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>关于</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span></a></li><li><a href=/%E9%93%BE%E6%8E%A5/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>链接</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://adja.com.cn/ selected>中文</option><option value=https://adja.com.cn/en/>English</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#制作u盘引导>制作U盘引导</a><ol><li><a href=#系统安装>系统安装</a></li></ol></li><li><a href=#系统使用>系统使用</a><ol><li><a href=#登录synology账户>登录Synology账户</a></li><li><a href=#ddns与证书续期>DDNS与证书续期</a></li><li><a href=#sso单点登录>SSO单点登录</a></li></ol></li><li><a href=#参考>参考</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/synology-user-experience/><img src=/p/synology-user-experience/cover_hu_589180217aaf64dc.jpg srcset="/p/synology-user-experience/cover_hu_589180217aaf64dc.jpg 800w, /p/synology-user-experience/cover_hu_3af29d6990e754ec.jpg 1600w" width=800 height=496 loading=lazy alt="Featured image of post 黑群晖使用体验"></a></div><div class=article-details><header class=article-category><a href=/categories/%E6%8A%98%E8%85%BE/>折腾
</a><a href=/categories/%E7%BD%91%E7%BB%9C/>网络
</a><a href=/categories/%E5%AE%9E%E8%B7%B5/>实践</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/synology-user-experience/>黑群晖使用体验</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jun 28, 2023</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 4 分钟</time></div></footer><footer class=article-translations><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><div><a href=https://adja.com.cn/en/p/synology-user-experience/ class=link>English</a></div></footer></div></header><section class=article-content><h1 id=黑群晖使用体验>黑群晖使用体验</h1><p> 刚毕业想到去年在淘宝买的<code>蜗牛星际NAS存储</code>，直到有较充裕的时间开始折腾下;</p><p> 说明下我的NAS为四盘位的蜗牛星际，待安装的系统为7.1.0-42661，可参考<a class=link href=http://k.8x6x.com/thread-72641-1-1.html target=_blank rel=noopener>该文章</a>，由于该教程过于简陋，所以下面介绍我的安装过程，顺便补充系统使用上的问题.</p><h2 id=制作u盘引导>制作U盘引导</h2><p> 引导一定要根据系统型号与版本进行选择，一般商家会提供U盘引导，并提供了特定pat文件;后续如果升级系统，可参考该引导配置制作新的U盘引导，最好用新的U盘制作U引导，下面介绍U盘引导的制作.</p><ol><li>准备工作</li></ol><p> 首先需要下载必要工具，链接：https://pan.baidu.com/s/1o8v7xdCPXgh3zIocm-iPcA
 提取码：adja</p><p> 先烧录7.1的镜像，再修改U盘的grub.cfg文件，待修改参数包括pid、vid、sn、mac1、mac2、netif_num、DiskIdxMap、SataPortMap和SasIdxMap;</p><ol start=2><li>获取pid、vid</li></ol><p> pid和vid参数可在插入U盘后，通过<code>ChipEasyv1.6(pid vid读取工具）.exe</code>获取;</p><ol start=3><li>获取sn、mac、netif_num</li></ol><p> sn和mac(指mac1、mac2)可保持不变，也可以采用去某宝买全洗白的sn码;</p><p> netif_num表示网卡数量，有1个网卡则值为1，值为网卡数;</p><ol start=4><li>获取<em>DiskIdxMap</em>、<em>SataPortMap</em>和<em>SasIdxMap</em></li></ol><p> DiskIdxMap、SataPortMap和SasIdxMap可参考<a class=link href=https://www.openos.org/threads/diskidxmap-sataportmap-sasidxmap.3675/ target=_blank rel=noopener>该文章</a>，具体取值可问卖家客服或者通过tinycore工具(镜像为网盘的<code>tinycore-redpill.v0.9.4.9.img</code>文件，需烧录到U盘插入NAS)，tinycore工具使用可参考<a class=link href=https://blog.csdn.net/qq_35379989/article/details/129287254 target=_blank rel=noopener>该文章</a>，由于没有显示屏只有物理机无法看到NAS重启的引导界面，并且nas不好拆机，所以DiskIdxMap等直接采用卖家提供引导U盘的参数;</p><p> <em>SataPortMap</em>: 描述各控制器的接口数，比如<code>SataPortMap=22</code>，表示第1个控制器有2个接口、第2个控制有2个接口，<code>SataPortMap=345</code>，表示第1个控制器有3个接口、第2个控制有4个接口、第3个控制有5个接口;</p><p> <em>DiskIdxMap</em>: 描述磁盘的顺序，用2位16进制数表示1个控制器，比如<code>SataPortMap=22 DiskIdxMap=0002</code>，表示第1个控制器从第0号(00)磁盘开始，第2个控制器从第2号(02)磁盘开始，又比如<code>SataPortMap=345 DiskIdxMap=070c00</code>，表示第1个控制器从第7号(07)磁盘开始，第2个控制器从第12号(0c)磁盘开始，第3个控制器从第0号磁盘(00)开始，假设各控制器头顺序为<code>BCA</code>，如果<code>DiskIdxMap</code>取值为<code>00070c</code>，则顺序为<code>ABC</code>;</p><p> <em>SasIdxMap</em>: 不清楚具体功能，文章说按照正确的顺序，默认加上;</p><ol start=5><li>烧录镜像与修改<em>grub.cfg</em></li></ol><p> <code>Diskgenius（改pid vid sn mac删除硬盘）.exe</code>用于修改img镜像文件，但不建议修改，由于只要修改grub.cfg文件，可先烧录img镜像到U盘，然后在U盘中修改;</p><p> 上面提到的烧录工具为<code>Win32DiskImager(写盘工具）.exe</code>，选择镜像和盘符，然后点击写入直到进度条满.</p><p> 最后给出我的grub.cfg文件:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>terminal_output console
</span></span><span class=line><span class=cl>if serial --unit=0 --speed=115200; then
</span></span><span class=line><span class=cl>    terminal_input --append serial_com0
</span></span><span class=line><span class=cl>    terminal_output --append serial_com0
</span></span><span class=line><span class=cl>fi
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>set default=&#34;0&#34;
</span></span><span class=line><span class=cl>set timeout=&#34;5&#34;
</span></span><span class=line><span class=cl>set timeout_style=&#34;menu&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>if [ -s $prefix/grubenv ]; then
</span></span><span class=line><span class=cl>    load_env --file $prefix/grubenv --skip-sig
</span></span><span class=line><span class=cl>    set has_env=&#34;1&#34;
</span></span><span class=line><span class=cl>    if [ -n &#34;${saved_entry}&#34; ]; then
</span></span><span class=line><span class=cl>        set default=&#34;${saved_entry}&#34;
</span></span><span class=line><span class=cl>    fi
</span></span><span class=line><span class=cl>else
</span></span><span class=line><span class=cl>    set has_env=&#34;0&#34;
</span></span><span class=line><span class=cl>    echo &#34;WARN: failed to load env. Default choice will NOT be saved!&#34;
</span></span><span class=line><span class=cl>fi
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>function savedefault {
</span></span><span class=line><span class=cl>    saved_entry=&#34;${chosen}&#34;
</span></span><span class=line><span class=cl>    save_env --file $prefix/grubenv saved_entry
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>insmod usb_keyboard
</span></span><span class=line><span class=cl>insmod part_msdos
</span></span><span class=line><span class=cl>insmod ext2
</span></span><span class=line><span class=cl>insmod fat
</span></span><span class=line><span class=cl>insmod linux
</span></span><span class=line><span class=cl>insmod gzio
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>set gfxmode=auto
</span></span><span class=line><span class=cl>insmod vbe
</span></span><span class=line><span class=cl>insmod vga
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># UEFI
</span></span><span class=line><span class=cl>insmod efi_gop
</span></span><span class=line><span class=cl>insmod efi_uga
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>insmod font
</span></span><span class=line><span class=cl>if loadfont ${prefix}/unicode.pf2
</span></span><span class=line><span class=cl>then
</span></span><span class=line><span class=cl>    insmod gfxterm
</span></span><span class=line><span class=cl>    set gfxmode=auto
</span></span><span class=line><span class=cl>    set gfxpayload=keep
</span></span><span class=line><span class=cl>    terminal_output gfxterm
</span></span><span class=line><span class=cl>fi
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>menuentry &#39;RedPill DS918+ v7.1.0-42661 (USB, Verbose)&#39; {
</span></span><span class=line><span class=cl>	savedefault
</span></span><span class=line><span class=cl>	set root=(hd0,msdos1)
</span></span><span class=line><span class=cl>	echo Loading Linux...
</span></span><span class=line><span class=cl>	linux /zImage HddHotplug=0 withefi console=ttyS0,115200n8 netif_num=2 syno_hdd_detect=0 syno_port_thaw=1 vender_format_version=2 sn=xxx mac1=xxx mac2=xxx earlyprintk syno_hdd_powerup_seq=1 pid=0x5678 log_buf_len=32M syno_hw_version=DS918+ vid=0xffff earlycon=uart8250,io,0x3f8,115200n8 elevator=elevator root=/dev/md0 loglevel=15 DiskIdxMap=0002 SataPortMap=22 SasIdxMap=0
</span></span><span class=line><span class=cl>	echo Loading initramfs...
</span></span><span class=line><span class=cl>	initrd /rd.gz /custom.gz
</span></span><span class=line><span class=cl>	echo Starting kernel with USB boot
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>menuentry &#39;RedPill DS918+ v7.1.0-42661 (SATA, Verbose)&#39; {
</span></span><span class=line><span class=cl>	savedefault
</span></span><span class=line><span class=cl>	set root=(hd0,msdos1)
</span></span><span class=line><span class=cl>	echo Loading Linux...
</span></span><span class=line><span class=cl>	linux /zImage HddHotplug=0 withefi console=ttyS0,115200n8 synoboot_satadom=2 DiskIdxMap=00 netif_num=1 syno_hdd_detect=0 syno_port_thaw=1 SasIdxMap=0 vender_format_version=2 earlyprintk mac1=xxx syno_hdd_powerup_seq=1 pid=0x5678 log_buf_len=32M syno_hw_version=DS918+ vid=0xffff earlycon=uart8250,io,0x3f8,115200n8 sn=xxx elevator=elevator root=/dev/md0 loglevel=15 SataPortMap=1
</span></span><span class=line><span class=cl>	echo Loading initramfs...
</span></span><span class=line><span class=cl>	initrd /rd.gz /custom.gz
</span></span><span class=line><span class=cl>	echo Starting kernel with SATA boot
</span></span><span class=line><span class=cl>	echo WARNING: SATA boot support on this platform is experimental!
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><h3 id=系统安装>系统安装</h3><p> 在安装之前，需要运行<code>synology-assistant-7.win系统版.exe</code>安装程序，在网盘已提供，用于扫描局域网中存在的NAS;</p><p> 在制作完成U盘引导后，插入到NAS中，然后启动NAS，运行<code>Synology Assistant</code>，安装过程略;</p><p><font size=3 color=red>注意</font></p><ol><li><p>对于黑群晖，在安装过程中最好断网，即便是全洗白的(有时成功、但也有失败)，最后导致系统被锁，无限还原，在出现10分钟倒计时开始就断开与互联网的连接;</p></li><li><p>对于初学者，提前准备1个硬盘盒(3.5寸)、多个引导U盘，当系统无限还原，那么就格式化磁盘吧，过程略;</p></li><li><p>系统如果需要升级，需做好备份，然后找到对应的img镜像和pat文件，再尝试新U盘制作引导，由于没亲历过(只重装系统)，可参考<a class=link href="https://post.smzdm.com/p/a0q4zgx9/p4/?sort_tab=hot/#comments" target=_blank rel=noopener>该文章</a></p></li></ol><h2 id=系统使用>系统使用</h2><p> 在装完系统后，可以体验群晖简单实用的功能了，但其中有些注意点，可参考<a class=link href="https://www.ainas.cc:88/?page_id=8" target=_blank rel=noopener>该系列文章</a>:</p><h3 id=登录synology账户>登录Synology账户</h3><p> 由于许多功能依赖于群晖账户，比如QuickConnect、ActiveInsight、DDNS等，此外还有其他的一些功能;</p><p> 群晖账户尽量在全球站注册，可参考<a class=link href="https://www.ainas.cc:88/?p=572" target=_blank rel=noopener>该文章</a>，具体原因也在其中说明;</p><p> 注册完账户后，可在群晖控制面板中登录群晖账户，然后可体验部分功能，QuickConnect需绑定电话(但不建议绑定，会导致群晖变黑)，DDNS可直接采用官方提供的域名(证书支持泛域名，较简单，但时常会失败);</p><h3 id=ddns与证书续期>DDNS与证书续期</h3><p> DDNS可查看先前我记录的<code>DDNS踩坑经历</code>文章，DDNS服务提供商建议采用Cloudflare，将域名的DNS服务器设为Cloudflare(CF)的，主要是为了方便之后通过acme.sh自动申请证书，经过测试采用dns_dp即腾讯的域名解析，申请不知为何原因失败，到了第二天换成dns_cf一次便成功，下面介绍整个过程;</p><ol><li>DDNS配置</li></ol><p> 前提条件，具备公网IPv4或IPv6，家庭的话IPv6应该都有，没的话需咨询宽带提供商，如果因为光猫配置问题，可致电询问光猫超级用户账号密码(用于将路由桥接修改为路由模式)，或者参考网上教程去破解(需注意型号问题);</p><p> 对于DDNS，首先需购买域名，然后将其DNS服务器设置为CF的，接着在系统中可以通过docker或套件中心来安装<code>DDNS-GO</code>;</p><p> 然后在CF中添加该域名，并在<a class=link href=https://dash.cloudflare.com/profile target=_blank rel=noopener>My Profile</a>中的<code>API Tokens</code>分别添加<code>API Token</code>(用于DDNS-GO服务)和<code>Global API Key</code>(用于自动申请证书)</p><p> 其中，<code>API Token</code>中选择<code>Create Token</code>，模板选择<code>Edit zone DNS</code>，在<code>Zone Resources</code>中选择包含的可作用域名;<code>Global API Key</code>可直接查看，略;</p><ol start=2><li>证书申请</li></ol><p> 需要注意几个问题，证书是否需要泛域名，证书是否频繁更新，根据需求选择采用ZeroSSL还是Letsencrypt证书提供商;</p><p> 关于泛域名，如果没有相关需求，建议采用ZeroSSL，优势是不限制申请次数;</p><p> 群晖支持采用Letsencrypt申请泛域名证书，但只为群晖提供的域名后缀提供服务，因此若不采用群晖的DDNS，且考虑到便利性，那么需要借助类似<code>acme.sh</code>的工具来自动申请证书，可参考<a class=link href=https://post.smzdm.com/p/a6d5dl6e/ target=_blank rel=noopener>该文章</a>，具体过程如下:</p><p> 首先，需要申请证书，这里<code>acme.sh</code>采用dns_cf的方式，需要借助上文提到的<code>Global API Key</code>的<code>Global API Key</code>和该账户的邮箱，然后在ssh终端执行以下指令:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 你的域名</span>
</span></span><span class=line><span class=cl><span class=nv>DOMAIN</span><span class=o>=</span><span class=s1>&#39;xxx.xxx&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># DNS供应商 可选 dns_dp(腾讯云) dns_ali(阿里云)  dns_cf  其他可查https://github.com/acmesh-official/acme.sh/wiki/dnsapi</span>
</span></span><span class=line><span class=cl><span class=nv>DNS</span><span class=o>=</span><span class=s2>&#34;dns_cf&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>#证书供应商</span>
</span></span><span class=line><span class=cl><span class=nv>CERT_SERVER</span><span class=o>=</span><span class=s2>&#34;letsencrypt&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>CF_Key</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>CF_Email</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=cl>docker run --rm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -v <span class=s2>&#34;/volume1/docker/acme:/acme.sh&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=s2>&#34;CF_Key=</span><span class=si>${</span><span class=nv>CF_Key</span><span class=si>}</span><span class=s2>&#34;</span> -e <span class=s2>&#34;CF_Email=</span><span class=si>${</span><span class=nv>CF_Email</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  neilpang/acme.sh <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  acme.sh --dns <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DNS</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --server <span class=s2>&#34;</span><span class=si>${</span><span class=nv>CERT_SERVER</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --issue -d <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span><span class=s2>&#34;</span> -d <span class=s2>&#34;*.</span><span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p> 可能由于网络或脚本版本问题，Letsencrypt证书不一定一次成功，需注意申请次数不能短时间太多，当出现Success，至此已经申请到带泛域名的证书，然后需要将证书通过acme.sh提供的群晖部署方式部署，脚本如下:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1>#群晖账号密码</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Username</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Password</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#如果开启了双重验证请在浏览器登录时选中保存此设备，然后从COOKIE中获取did cookie</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_TOTP_SECRET</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>#以下群晖配置非必要不要更改</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Hostname</span><span class=o>=</span><span class=s2>&#34;localhost&#34;</span> <span class=c1># Specify if not using on localhost</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Scheme</span><span class=o>=</span><span class=s2>&#34;http&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Port</span><span class=o>=</span><span class=s2>&#34;5000&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 经测试发现localhost不行，而通过网卡的IPv4可以</span>
</span></span><span class=line><span class=cl><span class=nv>ipv4</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>ifconfig eth0 <span class=p>|</span> grep -E <span class=s1>&#39;inet addr&#39;</span> <span class=p>|</span> cut -d: -f2 <span class=p>|</span> awk <span class=s1>&#39;{print $1}&#39;</span>
</span></span><span class=line><span class=cl><span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Hostname</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>ipv4</span><span class=si>}</span><span class=s2>&#34;</span> <span class=c1># Specify if not using on localhost</span>
</span></span><span class=line><span class=cl><span class=c1>#要添加的证书的名字，空字符串（&#34;&#34;）的话就是替代默认证书，一般建议使用空字符串，除非你有多个证书</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Certificate</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>  <span class=c1># 建议和域名保持一致</span>
</span></span><span class=line><span class=cl><span class=c1># 以下为acme.sh通过dsm_deploy部署到系统的必要参数</span>
</span></span><span class=line><span class=cl><span class=nv>c</span><span class=o>=</span><span class=s2>&#34;SYNO_Username=</span><span class=si>${</span><span class=nv>SYNO_Username</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>d</span><span class=o>=</span><span class=s2>&#34;SYNO_Password=</span><span class=si>${</span><span class=nv>SYNO_Password</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>e</span><span class=o>=</span><span class=s2>&#34;SYNO_TOTP_SECRET=</span><span class=si>${</span><span class=nv>SYNO_TOTP_SECRET</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>f</span><span class=o>=</span><span class=s2>&#34;SYNO_Hostname=</span><span class=si>${</span><span class=nv>SYNO_Hostname</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>g</span><span class=o>=</span><span class=s2>&#34;SYNO_Scheme=</span><span class=si>${</span><span class=nv>SYNO_Scheme</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>h</span><span class=o>=</span><span class=s2>&#34;SYNO_Port=</span><span class=si>${</span><span class=nv>SYNO_Port</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>i</span><span class=o>=</span><span class=s2>&#34;SYNO_Certificate=</span><span class=si>${</span><span class=nv>SYNO_Certificate</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>j</span><span class=o>=</span><span class=s2>&#34;SYNO_DID=</span><span class=si>${</span><span class=nv>SYNO_TOTP_SECRET</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>docker run --rm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -v <span class=s2>&#34;/volume1/docker/acme:/acme.sh&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=si>${</span><span class=nv>c</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>d</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>e</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>f</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>g</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>h</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>i</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>j</span><span class=si>}</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  neilpang/acme.sh <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  acme.sh --dns <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DNS</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --issue -d <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span><span class=s2>&#34;</span> -d <span class=s2>&#34;*.</span><span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --deploy --deploy-hook synology_dsm
</span></span></code></pre></td></tr></table></div></div><p> 至此，通过acme.sh的docker容器申请证书与部署到群晖已完成，脚本参考<a class=link href=https://github.com/GuaiMiu/Synology-Auto-SSL/blob/main/acme.sh target=_blank rel=noopener>该仓库</a>，修改后的脚本如下:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># 你的域名</span>
</span></span><span class=line><span class=cl><span class=nv>DOMAIN</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#证书供应商</span>
</span></span><span class=line><span class=cl><span class=nv>CERT_SERVER</span><span class=o>=</span><span class=s1>&#39;letsencrypt&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#DNS供应商 可选 dns_dp(腾讯云) dns_ali(阿里云)  dns_cf  其他可查https://github.com/acmesh-official/acme.sh/wiki/dnsapi</span>
</span></span><span class=line><span class=cl><span class=nv>DNS</span><span class=o>=</span><span class=s2>&#34;dns_cf&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>#群晖账号密码</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Username</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Password</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#如果开启了双重验证请在浏览器登录时选中保存此设备，然后从COOKIE中获取did cookie</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_TOTP_SECRET</span><span class=o>=</span><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>#以下群晖配置非必要不要更改</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Hostname</span><span class=o>=</span><span class=s2>&#34;localhost&#34;</span> <span class=c1># Specify if not using on localhost</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Scheme</span><span class=o>=</span><span class=s2>&#34;http&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Port</span><span class=o>=</span><span class=s2>&#34;5000&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>ipv4</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>ifconfig eth0 <span class=p>|</span> grep -E <span class=s1>&#39;inet addr&#39;</span> <span class=p>|</span> cut -d: -f2 <span class=p>|</span> awk <span class=s1>&#39;{print $1}&#39;</span>
</span></span><span class=line><span class=cl><span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Hostname</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>ipv4</span><span class=si>}</span><span class=s2>&#34;</span> <span class=c1># Specify if not using on localhost</span>
</span></span><span class=line><span class=cl><span class=c1>#要添加的证书的名字，空字符串（&#34;&#34;）的话就是替代默认证书，一般建议使用空字符串，除非你有多个证书</span>
</span></span><span class=line><span class=cl><span class=nv>SYNO_Certificate</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#以下三选一</span>
</span></span><span class=line><span class=cl><span class=c1>#DNSPOD.CN 腾讯云</span>
</span></span><span class=line><span class=cl><span class=nv>DP_Id</span><span class=o>=</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>DP_Key</span><span class=o>=</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#阿里云</span>
</span></span><span class=line><span class=cl><span class=nv>Ali_Key</span><span class=o>=</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>Ali_Secret</span><span class=o>=</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>#CF</span>
</span></span><span class=line><span class=cl><span class=nv>CF_Key</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>CF_Email</span><span class=o>=</span><span class=s1>&#39;xxx&#39;</span>
</span></span><span class=line><span class=cl><span class=k>case</span> <span class=nv>$DNS</span> in
</span></span><span class=line><span class=cl>    <span class=s2>&#34;dns_dp&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>a</span><span class=o>=</span><span class=s2>&#34;DP_Id=</span><span class=si>${</span><span class=nv>DP_Id</span><span class=si>}</span><span class=s2>&#34;</span><span class=o>&amp;&amp;</span><span class=nv>b</span><span class=o>=</span><span class=s2>&#34;DP_Key=</span><span class=si>${</span><span class=nv>DP_Key</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>;;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;dns_ali&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>a</span><span class=o>=</span><span class=s2>&#34;Ali_Key=</span><span class=si>${</span><span class=nv>Ali_Key</span><span class=si>}</span><span class=s2>&#34;</span><span class=o>&amp;&amp;</span><span class=nv>b</span><span class=o>=</span><span class=s2>&#34;Ali_Secret=</span><span class=si>${</span><span class=nv>Ali_Secret</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>;;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;dns_cf&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>a</span><span class=o>=</span><span class=s2>&#34;CF_Key=</span><span class=si>${</span><span class=nv>CF_Key</span><span class=si>}</span><span class=s2>&#34;</span><span class=o>&amp;&amp;</span><span class=nv>b</span><span class=o>=</span><span class=s2>&#34;CF_Email=</span><span class=si>${</span><span class=nv>CF_Email</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>;;</span>
</span></span><span class=line><span class=cl><span class=k>esac</span>
</span></span><span class=line><span class=cl><span class=nv>c</span><span class=o>=</span><span class=s2>&#34;SYNO_Username=</span><span class=si>${</span><span class=nv>SYNO_Username</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>d</span><span class=o>=</span><span class=s2>&#34;SYNO_Password=</span><span class=si>${</span><span class=nv>SYNO_Password</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>e</span><span class=o>=</span><span class=s2>&#34;SYNO_TOTP_SECRET=</span><span class=si>${</span><span class=nv>SYNO_TOTP_SECRET</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>f</span><span class=o>=</span><span class=s2>&#34;SYNO_Hostname=</span><span class=si>${</span><span class=nv>SYNO_Hostname</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>g</span><span class=o>=</span><span class=s2>&#34;SYNO_Scheme=</span><span class=si>${</span><span class=nv>SYNO_Scheme</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>h</span><span class=o>=</span><span class=s2>&#34;SYNO_Port=</span><span class=si>${</span><span class=nv>SYNO_Port</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>i</span><span class=o>=</span><span class=s2>&#34;SYNO_Certificate=</span><span class=si>${</span><span class=nv>SYNO_Certificate</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>j</span><span class=o>=</span><span class=s2>&#34;SYNO_DID=</span><span class=si>${</span><span class=nv>SYNO_TOTP_SECRET</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 申请证书</span>
</span></span><span class=line><span class=cl>docker run --rm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -v <span class=s2>&#34;/volume1/docker/acme:/acme.sh&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=si>${</span><span class=nv>a</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>b</span><span class=si>}</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  neilpang/acme.sh <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  acme.sh --dns <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DNS</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --server <span class=s2>&#34;</span><span class=si>${</span><span class=nv>CERT_SERVER</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --renew -d <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span><span class=s2>&#34;</span> -d <span class=s2>&#34;*.</span><span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c1>#  --issue -d &#34;${DOMAIN}&#34; -d &#34;*.${DOMAIN}&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 部署证书到群晖</span>
</span></span><span class=line><span class=cl>docker run --rm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -v <span class=s2>&#34;/volume1/docker/acme:/acme.sh&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -e <span class=si>${</span><span class=nv>c</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>d</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>e</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>f</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>g</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>h</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>i</span><span class=si>}</span> -e <span class=si>${</span><span class=nv>j</span><span class=si>}</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  neilpang/acme.sh <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  acme.sh --dns <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DNS</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --issue -d <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span><span class=s2>&#34;</span> -d <span class=s2>&#34;*.</span><span class=si>${</span><span class=nv>DOMAIN</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --deploy --deploy-hook synology_dsm
</span></span></code></pre></td></tr></table></div></div><p> 如果想要定时更新证书，可在控制面板中的<code>任务计划</code>添加任务，由于有些指令与目录访问需要高权限，比如docker指令和某些路径，以root身份执行，每月执行一次;</p><p> 但仍存在些小问题，比如两步验证，开启了两步验证，但没有配置<code>SYNO_TOTP_SECRET</code>参数，执行脚本仍可以成功;采用腾讯云的api-id和api-key方式申请Letsencrypt证书始终不成功，在相关Issue中说明需更新acme.sh或换网络等，具体没尝试过.</p><h3 id=sso单点登录>SSO单点登录</h3><p> 琢磨良久，没成功，暂时略，后续补充.</p><h2 id=参考>参考</h2><ol><li><p><a class=link href=http://k.8x6x.com/thread-72641-1-1.html target=_blank rel=noopener>http://k.8x6x.com/thread-72641-1-1.html</a></p></li><li><p><a class=link href=https://www.openos.org/threads/diskidxmap-sataportmap-sasidxmap.3675/ target=_blank rel=noopener>https://www.openos.org/threads/diskidxmap-sataportmap-sasidxmap.3675/</a></p></li><li><p><a class=link href=https://blog.csdn.net/qq_35379989/article/details/129287254 target=_blank rel=noopener>https://blog.csdn.net/qq_35379989/article/details/129287254</a></p></li><li><p><a class=link href="https://post.smzdm.com/p/a0q4zgx9/p4/?sort_tab=hot/#comments" target=_blank rel=noopener>https://post.smzdm.com/p/a0q4zgx9/p4/?sort_tab=hot/#comments</a></p></li><li><p><a class=link href="https://www.ainas.cc:88/?page_id=8" target=_blank rel=noopener>https://www.ainas.cc:88/?page_id=8</a></p></li><li><p><a class=link href="https://www.ainas.cc:88/?p=572" target=_blank rel=noopener>https://www.ainas.cc:88/?p=572</a></p></li><li><p><a class=link href=https://post.smzdm.com/p/a6d5dl6e/ target=_blank rel=noopener>https://post.smzdm.com/p/a6d5dl6e/</a></p></li></ol><hr><p><font color=blue size=3>2023-06-28 首次更新</font></p></section><footer class=article-footer><section class=article-tags><a href=/tags/%E7%BD%91%E7%BB%9C/>网络</a>
<a href=/tags/%E5%AE%9E%E8%B7%B5/>实践</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>最后更新于 Dec 08, 2024 15:41 +0800</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/crack-the-optical-modem-superuser-password/><div class=article-image><img src=/p/crack-the-optical-modem-superuser-password/cover.4745bae10689c0b0d2c0e3d5beb006d7_hu_df17ca5c208c247f.jpg width=250 height=150 loading=lazy alt="Featured image of post 破解光猫超级用户密码" data-key="crack the optical modem superuser password" data-hash="md5-R0W64QaJwLDSwOPVvrAG1w=="></div><div class=article-details><h2 class=article-title>破解光猫超级用户密码</h2></div></a></article><article class=has-image><a href=/p/remote-networking/><div class=article-image><img src=/p/remote-networking/cover.62135337d8a5fe3b3d993df7362149c9_hu_66f60d245367cbe9.jpg width=250 height=150 loading=lazy alt="Featured image of post 异地组网联机游戏" data-key="remote networking" data-hash="md5-YhNTN9il/js9mT33NiFJyQ=="></div><div class=article-details><h2 class=article-title>异地组网联机游戏</h2></div></a></article><article class=has-image><a href=/p/use-ddns-to-access-intranet-devices/><div class=article-image><img src=/p/use-ddns-to-access-intranet-devices/cover.d4055176327be5efebf9a34e1a1de825_hu_c54885035437fcd4.jpg width=250 height=150 loading=lazy alt="Featured image of post 使用DDNS访问内网设备" data-key="use ddns to access intranet devices" data-hash="md5-1AVRdjJ75e/r+aNOGh3oJQ=="></div><div class=article-details><h2 class=article-title>使用DDNS访问内网设备</h2></div></a></article><article class=has-image><a href=/p/automated-build-via-jenkins/><div class=article-image><img src=/p/automated-build-via-jenkins/cover.e85b93994bf8f6ec7cb96ae0596e92df_hu_427a4039e8747044.jpg width=250 height=150 loading=lazy alt="Featured image of post 通过Jenkins自动化构建" data-key="automated build via jenkins" data-hash="md5-6FuTmUv49ux8uWrgWW6S3w=="></div><div class=article-details><h2 class=article-title>通过Jenkins自动化构建</h2></div></a></article><article class=has-image><a href=/p/blog-migration/><div class=article-image><img src=/p/blog-migration/cover.db184ce4514704e1057a2469166af60e_hu_74fd9819a64a169.jpg width=250 height=150 loading=lazy alt="Featured image of post 博客迁移" data-key="blog migration" data-hash="md5-2xhM5FFHBOEFeiRpFmr2Dg=="></div><div class=article-details><h2 class=article-title>博客迁移</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 Loong</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>